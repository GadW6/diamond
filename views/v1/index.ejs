<%- include('../includes/head'); -%>
<link rel="stylesheet" href="../css/main.css" />
<style>
	textarea#input-email::placeholder {
		padding-top: calc(3rem - 2px);
	}

</style>
</head>

<body>
	<div class="container-fluid">
		<div id="myNav" class="hidden">
			<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
			<div class="hidden-content">
				<a href="#home" onclick="closeNav()">Home</a>
				<a href="./gallery" onclick="closeNav()">gallery</a>
				<a href="#about" onclick="closeNav()">About</a>
				<a href="#contact" onclick="closeNav()">Contact</a>
			</div>
		</div>
		<span id="burger" onclick="openNav()">&#9776;</span>
		<div class="hero">
			<div class="container">
				<nav class="navigation">
					<a class="logo" href="/"><strong>YW | Diamonds</strong></a>
					<ul>
						<li><a id="active" href="#home">home</a></li>
						<li><a href="./gallery">gallery</a></li>
						<li><a href="#about">about</a></li>
						<li><a href="#contact">contact</a></li>
					</ul>
				</nav>
				<div class="hero-shape"><img src="./img/hero-diamond.svg" alt="" /></div>
				<div class="title">
					<h2>
						<b><strong><%- site.titleHero -%></strong></b>
					</h2>
					<p>
						<%- site.subTitleHero -%>
					</p>
				</div>
				<img id="di-bg" src="./img/diamond-sm.svg" alt="Small diamond pic" />
				<img id="di-sm" src="./img/diamond-bg.svg" alt="Big diamond pic" />
				<img id="di-rings" src="./img/rings.svg" alt="Diamond rings pic" style="display: none;" />
			</div>
		</div>
		<div class="about_me" id="about" style="background-color: #dcdcdc;">
			<div class="container d-flex justify-content-center align-items-center">
				<blockquote>
					<div class="row">
						<div class="col-12 text-center">
							<img class="img-circle" src="./img/yair_profile.png" style="width: 100px; height: 100px;" />
						</div>
						<div class="col-12 text-center">
							<b class="col-6 d-block mx-auto mt-3"><i class="fa fa-quote-left mr-2"></i><%- site.bodyQuote -%><i
									class="fa fa-quote-right ml-2"></i>
							</b>
							<small><i class="fa fa-minus mr-2" style="font-size: smaller;"></i><%- site.authQuote -%></small>
						</div>
					</div>
				</blockquote>
			</div>
		</div>
		<div class="contact" id="contact">
			<div class="container">
				<div class="row h-100 py-5">
					<div class="col my-auto d-flex justify-content-center">
						<div class="contact_group">
							<h1 class="d-inline-block m-0" style="border-bottom: 1px solid #c2c2c2;">
								Contact Us:
							</h1>
							<h6 class="mb-3 mt-5">
								<b class="mr-1">Phone:</b><a href="tel:00<%- site.phone -%>"
									style="color: inherit;">00<%- site.phone -%></a>
							</h6>
							<h6 class="mb-3">
								<b class="mr-1">E-Mail:</b><a href="mailto:<%- site.email -%>"
									style="color: inherit;"><%- site.email -%></a>
							</h6>
							<h6 class="mb-3 d-flex flex-row">
								<b class="mr-1">Address:</b>
								<p><%- site.baseAdd -%>, <br /><%- site.cityAdd -%>, <br /><%- site.countryAdd -%></p>
							</h6>
						</div>
					</div>
					<div class="col my-auto d-flex justify-content-center">
						<iframe
							src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2499.213063458087!2d4.418070815759237!3d51.215150579588126!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47c3f703c7ad1681%3A0x85471a9dcd77208a!2sPelikaanstraat%2062%2C%202018%20Antwerpen%2C%20Belgium!5e0!3m2!1sen!2sil!4v1592930207746!5m2!1sen!2sil"
							width="400" height="300" frameborder="0" style="border:0;" allowfullscreen="" aria-hidden="false"
							tabindex="0"></iframe>
					</div>
				</div>
				<div class="sep w-75 mx-auto my-5 border-bottom border-secondary rounded-0"></div>
				<div class="h-100 pt-3 pb-5">
					<form action="" class="row w-75 mx-auto mb-5">
						<h5 class="text-center display-4 mb-5 mt-1 w-100">Get in touch:</h5>
						<div class="form-group col-sm-6 col-12">
							<label class="col-form-label d-none" for="input-name">Name</label>
							<input type="text" class="bg-transparent rounded-0 border-bottom border-light text-light w-100 py-1"
								placeholder="Name" id="input-name" name="input-name">
						</div>
						<div class="form-group col-sm-6 col-12">
							<label class="col-form-label d-none" for="input-email">Email</label>
							<input type="email" class="bg-transparent rounded-0 border-bottom border-light text-light w-100 py-1"
								placeholder="Email" id="input-email" name="input-email">
						</div>
						<div class="form-group col-12">
							<label class="col-form-label d-none" for="input-email">Email</label>
							<textarea class="bg-transparent rounded-0 border-bottom border-light text-light w-100 py-1" rows="3"
								placeholder="Write us.." id="input-email" name="input-email"></textarea>
						</div>
						<p class="text-danger d-none text-center w-100" id="errorText"></p>
						<button type="submit" class="btn btn-light text-light bg-transparent disabled rounded-0 mx-auto"
							onclick="sendMail(event)">Send</button>

					</form>
				</div>
			</div>
		</div>
		<span class="d-block" style="height: 1px; background-color: #ff0000;"></span>
		<footer class="py-4">
			<div class="container d-flex justify-content-between" style="color: #c2c2c2;">
				<a class="logo d-inline-block" href="#"><strong>YW | Diamonds</strong></a>
				<p class="d-inline-block my-0 mx-3" id="copyright">
					<small>Copyright &copy; <span id="year_now"></span>
						<a class="text-danger" href="http://itcloudpro.com">ITGLOBE</a>. All
						rights Reserved.</small>
				</p>
				<div class="right-footer">
					<a href="/terms" class="mr-3">Terms & Conditions</a>
					<a href="/privacy">Privacy Policy</a>
				</div>
			</div>
		</footer>
	</div>
	<script>
		// UI Elements
		const spanYear = document.querySelector('#year_now')

		// Self Loaded function
		const getNowYear = () => {
			const date = new Date()
			const now = date.getFullYear()
			spanYear.innerText = now
		}

		// Executing functions
		getNowYear()

		// Executable Functions
		const sendMail = (e) => {
			e.preventDefault()
			const nameRegx = /^[a-z ,.'-]+$/i
			const emailRegx =
				/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

			const nameField = e.target.parentElement.children[1].children[1]
			const name = nameField.value.trim()
			const nameVal = name.match(nameRegx)
			const emailField = e.target.parentElement.children[2].children[1]
			const email = emailField.value.trim()
			const emailVal = email.match(emailRegx)
			const bodyField = e.target.parentElement.children[3].children[1]
			const body = bodyField.value.trim()


			if (name && emailVal && body) {
				fetch('/', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json'
						},
						body: JSON.stringify({
							name: nameVal.input,
							email: emailVal.input,
							body
						})
					})
					.then(res => res.json())
					.then(res => {
						if (res.status === 'success') {
							e.target.parentElement.style.display = 'none'
							const parentDiv = e.target.parentElement.parentElement
							const newDiv = document.createElement('div')
							newDiv.className = 'my-5 text-center'
							newDiv.innerHTML = `
							<div><i style="font-size: 4rem;" class="fa fa-check-circle text-success mb-3"></i></div>
							<h3>Your mail was sent succesfully</h3>
							`
							parentDiv.appendChild(newDiv)
							setTimeout(() => {
								newDiv.remove()
								nameField.value = ''
								emailField.value = ''
								bodyField.value = ''
								e.target.parentElement.style.display = 'flex'
							}, 1500);
						} else console.log('Issue with Fetch')
					})
			} else {
				const error = document.querySelector('#errorText')
				error.innerText = '* Please fill out all fields properly'
				error.classList.remove('d-none')
				error.classList.add('d-block')
				setTimeout(() => {
					error.classList.remove('d-block')
					error.classList.add('d-none')
				}, 2000);
			}
		}

	</script>
	<%- include("../includes/foot") -%>
